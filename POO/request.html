<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Peticiones HTTP</title>
</head>

<body>
    <!-- <button id="request">Peticion GET</button> -->
    <button id="request">Peticion POST</button>
    <section id="container">
        Respuesta a peticion:
        <hr>
    </section>
    <script>
        // //PETICION GET
        // var req = new XMLHttpRequest();
        // req.open('GET','https://jsonplaceholder.typicode.com/posts',false);
        // req.send(null);
        // if (req.status==200) {
        //     console.log("Respuesta correcta");
        //     display(req.responseText);
        // }else
        //     console.log("La peticion falló");

        // function display(text){
        //     let element = document.getElementById("container");
        //     element.innerHTML += text;
        // }
        function enPantalla(text) {
            let element = document.getElementById('container');
            element.innerHTML += text;
        }


        function consola(text) {
            console.log(text);
        }



        // const req = new XMLHttpRequest();
        // req.addEventListener('load', () => {
        //     if (req.status === 200) {
        //         consola(req.responseText);
        //         consola(JSON.parse(req.responseText));
        //         enPantalla(req.responseText);
        //     } else
        //         consola([req.status, req.statusText]);
        // });

        // req.addEventListener('error', () => {
        //     consola('Error de red');
        // });

        // req.open('GET', 'https://jsonplaceholder.typicode.com/posts', true);
        // req.send(null);





        // const req = new XMLHttpRequest();

        // req.onload = function() {
        //     if (req.status >= 200 && req.status < 300) {
        //         consola(["success!", req]);
        //     } else
        //         consola("FALLOO");

        //     consola("Siempre ejecutar");

        // };

        // req.open('GET', 'https://jsonplaceholder.typicode.com/posts/1', true);
        // req.send();



        // let req = new XMLHttpRequest(),
        //     method = "GET",
        //     url = "https://jsonplaceholder.typicode.com/posts/1/comments";

        // req.open(method, url, true);
        // let contador = 0;

        // req.onreadystatechange = function() {
        //     consola(["cuantas veces se revisó?: ", contador]);
        //     contador++;
        //     if (req.readyState === XMLHttpRequest.DONE && req.status === 200) {
        //         consola(req.responseText);
        //         enPantalla(JSON.parse(req.responseText));
        //     }
        // };

        // document.getElementById('request').addEventListener('click', function() {
        //     this.style.display = 'none';
        //     req.send();
        // });



        let datos = {
            "delay": "5"
        }

        let request = new XMLHttpRequest();
        request.open("POST", "https://httpbin.org/delay/5", true);

        let contador = 0;
        request.onreadystatechange = function() {
            consola(["Cuantas veces se reviso? ", contador]);
            contador++;
            if (request.readyState === XMLHttpRequest.DONE && request.status === 200) {
                consola(request.responseText);
                enPantalla(request.responseText);

            }
        };

        document.getElementById("request").addEventListener("click", function() {
            this.style.display = "none";
            request.send();
        });
    </script>
</body>

</html>