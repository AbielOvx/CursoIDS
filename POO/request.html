<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Peticiones HTTP</title>
</head>

<body>
    <!-- <button id="request">Peticion GET</button> -->
    <button id="request">Peticion POST</button>
    <section id="container">
        Respuesta a peticion:
        <hr>
    </section>
    <script>
        // //PETICION GET
        // var req = new XMLHttpRequest();
        // req.open('GET','https://jsonplaceholder.typicode.com/posts',false);
        // req.send(null);
        // if (req.status==200) {
        //     console.log("Respuesta correcta");
        //     display(req.responseText);
        // }else
        //     console.log("La peticion falló");

        // function display(text){
        //     let element = document.getElementById("container");
        //     element.innerHTML += text;
        // }
        function enPantalla(text) {
            let element = document.getElementById('container');
            element.innerHTML += text;
        }


        function consola(text) {
            console.log(text);
        }



        // const req = new XMLHttpRequest();
        // req.addEventListener('load', () => {
        //     if (req.status === 200) {
        //         consola(req.responseText);
        //         consola(JSON.parse(req.responseText));
        //         enPantalla(req.responseText);
        //     } else
        //         consola([req.status, req.statusText]);
        // });

        // req.addEventListener('error', () => {
        //     consola('Error de red');
        // });

        // req.open('GET', 'https://jsonplaceholder.typicode.com/posts', true);
        // req.send(null);





        // const req = new XMLHttpRequest();

        // req.onload = function() {
        //     if (req.status >= 200 && req.status < 300) {
        //         consola(["success!", req]);
        //     } else
        //         consola("FALLOO");

        //     consola("Siempre ejecutar");

        // };

        // req.open('GET', 'https://jsonplaceholder.typicode.com/posts/1', true);
        // req.send();



        // let req = new XMLHttpRequest(),
        //     method = "GET",
        //     url = "https://jsonplaceholder.typicode.com/posts/1/comments";

        // req.open(method, url, true);
        // let contador = 0;

        // req.onreadystatechange = function() {
        //     consola(["cuantas veces se revisó?: ", contador]);
        //     contador++;
        //     if (req.readyState === XMLHttpRequest.DONE && req.status === 200) {
        //         consola(req.responseText);
        //         enPantalla(JSON.parse(req.responseText));
        //     }
        // };

        // document.getElementById('request').addEventListener('click', function() {
        //     this.style.display = 'none';
        //     req.send();
        // });



        // let datos = {
        //     "delay": "5"
        // }

        // let request = new XMLHttpRequest();
        // request.open("POST", "https://httpbin.org/delay/5", true);

        // let contador = 0;
        // request.onreadystatechange = function() {
        //     consola(["Cuantas veces se reviso? ", contador]);
        //     contador++;
        //     if (request.readyState === XMLHttpRequest.DONE && request.status === 200) {
        //         consola(request.responseText);
        //         enPantalla(request.responseText);

        //     }
        // };

        // document.getElementById("request").addEventListener("click", function() {
        //     this.style.display = "none";
        //     request.send();
        // });


        // const numero = (num) => {
        //     return parseInt(num);
        // }

        // const numero = num => parseInt(num);
        // const suma = (a,b)=>numero(a) + numero(b);

        


        // var petNames = [];
        // for (var i = 0; i < pets.length; i++) {
        //     petNames.push(pets[i].name);
        // }
        // consola(`Pets Names >> ${petNames}`);
        // consola(`Ejemplo template string A: ${5+5} `);
        // consola(`Ejemplo template string B ${petNames.length > 3 ? "ok" : "Cancel"}`);

        // const pets = [
        //     {name: "Lucho", especies:"eagle"},
        //     {name: "Juana", especies:"Iguana"},
        //     {name: "Martin", especies:"Dolphin"}
        // ];
        

        //animal es el parametro que esta recibiendo el arreglo pets para hacer referencia a cada uno de los objetos dentro
        // const petNames = pets.map(animal => animal.name);
        // consola(`Pets names with map: ${petNames}`);


        //funciones anonimas
        // function saluda(){
        //     console.log("Hola");
        // }

        // function Ejecutar(func){
        //     func();
        // }

        // Ejecutar(saluda);



        //IIFE Funcion autoinvocada
        // (function(){})();

    //    (function(a,b){
    //         consola(a+b);
    //     })(1,2);


    //     var suma = function(b,c){
    //         consola(b*c);
    //     }(4,3);


        //CAll BACK 
        //Funciones que invocan funciones y como parametro reciben funciones

        //Promesas

        let promise1 = new Promise((resolve, reject) => {
            setTimeout(function (){
                resolve("Resolucion correcta");
            },250);
        });

        promise1.then(mensaje => {
            consola(`Mesaje de resolucion: ${mensaje}`);
        });

         consola(promise1);

        let promise2 = new Promise(function(resolve, reject){
            setTimeout( function(){
                reject('Done! ');
            },250);
        })
        .then(function(e){
            console.log('done', e);
        })
        .catch(function(e){
            console.log('catch: ' , e);
        });
        
        consola(promise2);

        // let promise2 = new Promise(function(resolve, reject) {
        //     // Una tarea asíncrona usando setTimeout
        //     setTimeout( function() { 
        //         reject(‘Done!’);
        //         //reject(Error(‘Data could not be found’));
        //     }, 250);
        // })
        // .then( function(e) { console.log(‘done’, e); })
        // .catch( function(e) { console.log(‘catch: ’, e); });
        // console.log(promise2);
        // // From the console:
        // // ‘catch: Done!’


        function divide(dividendo, divisor){
            return new Promise ((resolve, reject)=> {
                if (divisor === 0) {
                    reject(new Error("No se puede dividir entre cero"));
                }else{
                    resolve(dividendo/divisor);
                }
            });
        }

        try {
            const result = divide(5,1);
            consola(result);
        }catch(err){
            console.err(mensaje);
        }


        new Promise(function(resolve, reject){
            setTimeout(function(){resolve(10);},250)
        })
        .then(function(num){console.log('First then ',num); return num * 2})
        .then(function(num){console.log('Second then ',num); return num * 2})
        .then(function(num){console.log('last then ',num);});



    </script>
</body>

</html>